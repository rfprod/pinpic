<!DOCTYPE html>
<html>
	<head>
		<title>Votin App</title>
		<script src="/public/js/jquery.min.js"></script>
	    <link href="/public/css/bootstrap.min.css" rel="stylesheet">
	    <script src="/public/js/bootstrap.min.js"></script>
	    <script src="/public/js/chart.js"></script>
		<link href="/public/css/main.css" rel="stylesheet" type="text/css">
		<link href='https://fonts.googleapis.com/css?family=Play&effect=outline' rel='stylesheet' type='text/css'>
	</head>
	<body>
		<div class="container-fluid nopadding"> 
		  <nav class="navbar navbar-inverse navbar-fixed-top topnav" role="navigation">
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#toggle-nav" aria-expanded="false">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="https://voting-app-rfprod.c9users.io"><span class="glyphicon glyphicon-stats"></span> Voting App</a> <a class="navbar-brand" href="https://github.com/rfprod/voting-application" target="_blank">GitHub Repo</a>
		    </div>
		    <div class="collapse navbar-collapse" id="toggle-nav">
		      <div class="container-fluid"> 
		        <ul class="nav navbar-nav navbar-right">
		          	<li class="nav-pills"><a href="/"><span class="glyphicon glyphicon-search"></span> All Polls</a></li>
		          	<li class="nav-pills active"><a href="#app"><span class="glyphicon glyphicon-user"></span> My Polls</a></li>
		          	<li class="nav-pills"><a href="/logout"><span class="glyphicon glyphicon-remove"></span> Logout</a></li>
		        </ul>
		      </div>
		    </div>
		  </nav>
		  <a name="app"></a>
		  <div class="home sect">
		    <div class="container-fluid">
		      <div class="col-md-12">
		        <p class="output"> 
		          	<div class="row profile">
						<img src="/public/img/gh-mark-32px.png" alt="github logo" />
						<span class="col-xs-3 col-sm-3 col-md-3 col-lg-2">ID: <span id="profile-id" class="profile-value"></span></span>
						<span class="col-xs-3 col-sm-3 col-md-3 col-lg-3">Username: <span id="profile-username" class="profile-value"></span></span>
						<span class="col-xs-3 col-sm-3 col-md-3 col-lg-3">Display Name: <span id="display-name" class="profile-value"></span></span>
						<span class="col-xs-3 col-sm-3 col-md-3 col-lg-2">Repositories: <span id="profile-repos" class="profile-value"></span></span>
						<span class="col-xs-3 col-sm-3 col-md-3 col-lg-2">Polls: <span id="profile-polls" class="profile-value"></span></span>
					</div>
					<div class="row">
						<div class="panel-group" id="accordion">
							<div class="panel panel-primary">
								<div class="panel-heading" type="button">
									 <h4 class="panel-title">
										  <a aria-expanded="false" class="cllps-toggler collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Add New Poll</a>
									 </h4>
								</div>
								<div style="height: 0px;" aria-expanded="false" id="collapseOne" class="panel-collapse collapse">								
									<div class="panel-body">
										<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
											<form role="form" action="/pollpost/" id="form" method="POST" enctype="application/x-www-form-urlencoded">
												<div class="form-group">
											 	   	<label for="owner">Owner ID:</label>
													<input type="text" class="form-control" name="owner" id="owner" value="" readonly>
												</div>
												<div class="form-group">
											 	   	<label for="name">Display name:</label>
											 	   	<input type="text" class="form-control" name="name" id="name" placeholder="Poll display name">
											 	</div>
												<div class="form-group">
											 	   	<label for="question">Question:</label>
											 	   	<input type="text" class="form-control" name="question" id="question" placeholder="Poll question.">
											 	</div>
											 	<div class="form-group">
											 	   	<label for="options">Options:</label>
											 	   	<input type="text" class="form-control" name="options" id="options" placeholder="separated by comma like: option 1, option 2, option 3 ">
											 	</div>
										 		<div class="btn-group btn-group-justified" role="group">
													<div class="btn-group" role="group">
														<button id="submit-btn" type="submit" class="btn btn-default btn-success btn-add-poll">Submit</button>
													</div>
													<div class="btn-group" role="group">
														<button type="reset" class="btn btn-default btn-danger">Reset</button>
													</div>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row polls">
						<div class="panel-group" id="accordion">
							<div class="panel panel-default">
								<div class="panel-heading" type="button">
									 <h4 class="panel-title">
										  <a aria-expanded="false" class="cllps-toggler collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">My Poll #1</a>
									 </h4>
								</div>
								<div style="height: 0px;" aria-expanded="false" id="collapseTwo" class="panel-collapse collapse">								
									<div class="panel-body">
										<canvas id="poll" class="col-xs-12 col-sm-7 col-md-7 col-lg-7"></canvas>
										<span class="legend">
											<span class="label label-default chrt-legend font-effect-outline" style="background-color:#0099CC;">Option #1</span>
											<span class="label label-default chrt-legend font-effect-outline" style="background-color:#800000;">Option #2</span>
											<span class="label label-default chrt-legend font-effect-outline" style="background-color:#FFFFB3;">Option #3</span>
											<span class="label label-default chrt-legend font-effect-outline" style="background-color:#B3FFFF;">Option #4</span>
										</span>
										<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
											<p>Some text.</p>
											<button type="button" class="btn btn-info btn-sm">Button 1</button>
											<button type="button" class="btn btn-info btn-sm">Button 2</button>
											<button type="button" class="btn btn-info btn-sm">Button 3</button>
											<button type="button" class="btn btn-info btn-sm">Button 4</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
		        </p>
		        <div class="container">
					<p>You have clicked the button <span id="click-nbr"></span> times.</p>
					<br />
					<div class="btn-group btn-group-justified" role="group">
						<div class="btn-group" role="group">
							<button type="submit" class="btn btn-info btn-add">CLICK ME!</button>
						</div>
						<div class="btn-group" role="group">
							<button class="btn btn-warning btn-delete">RESET</button>
						</div>
					</div>
				</div>
		        <span class="credits">credits</span>
		      </div>
		    </div>
		  </div>
		</div>
		<script type="text/javascript" src="common/ajax-functions.js"></script>
		<script type="text/javascript" src="controllers/clickController.client.js"></script>
		<script type="text/javascript" src="controllers/userController.client.js"></script>
		<script>
		$(document).ready(function(){
			$('#collapseOne').bind('shown.bs.collapse', function (e){
				$('html, body').animate({scrollTop: $(this).parent().offset().top-$("nav").height()});
				var ownerID = $('#profile-id').html();
				$('input[name="owner"]').val(ownerID);
			});
			$('#collapseTwo').bind('shown.bs.collapse', function (e){
				drawDoughnutChart(4);
				$('html, body').animate({scrollTop: $(this).parent().offset().top-$("nav").height()});
			});
			function getRandomColor(){
				function c(){return Math.floor(Math.random()*256).toString(16);}
				var colorHEX = "#"+c()+c()+c();
				if (colorHEX.length < 7) colorHEX += "b";
				//console.log("colorHEX: "+colorHEX);
				return colorHEX;
			}
			String.prototype.replaceAt = function(index, character){
			    return this.substr(0, index) + character + this.substr(index+character.length);
			};
			var values = [1, 4, 6, 8];
			var labels = ["Option #1", "Option #2", "Option #3", "Option #4"];
			function drawDoughnutChart(size){
				var doughnutContext = $("#poll").get(0).getContext("2d");
				doughnutContext.canvas.height = 175;
				var palette = [];
				var highlights = [];
				var data = [];
				for (var i=0;i<size;i++){
					(function getUniquePalette(){
						var randomColor = getRandomColor();
						if (palette.indexOf(randomColor) === -1 && highlights.indexOf(randomColor) === -1) palette.push(randomColor);
						else getUniquePalette();
					})();
					(function getUniqueHighlights(){
						var randomColor = getRandomColor();
						if (palette.indexOf(randomColor) === -1 && highlights.indexOf(randomColor) === -1) highlights.push(randomColor);
						else getUniqueHighlights();
					})();
					data.push({
						value: parseInt(values[i],10),
						color: palette[i],
						highlight: highlights[i],
						label: labels[i]
					});
				}
				console.log("palette: "+palette+" | "+"highlights: "+highlights);
				var options = {
					segmentShowStroke : true,
					segmentStrokeColor : "rgba(0,0,0,0.2)",
					segmentStrokeWidth : 2,
					percentageInnerCutout : 50,
					animationSteps : 100,
					animationEasing : "easeOutBounce",
					animateRotate : true,
					animateScale : true,
					legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>",
					tooltipTemplate: "<%= label %>: <%= value %>",
					tooltipFontSize: 16,
					tooltipFontStyle: "bold",
					tooltipFontColor: "#fff",
					tooltipTitleFontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif"
				};
				var doughnutChart = new Chart(doughnutContext).Doughnut(data, options);
				window.onresize = function(event) {
					doughnutChart.destroy();
					doughnutChart = new Chart(doughnutContext).Doughnut(data, options);
				};
			}
		});
		</script>
	</body>
</html>